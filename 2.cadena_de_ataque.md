
---

# üß© An√°lisis de cadena de ataque ‚Äî Basado en MITRE ATT&CK

## üìò Resumen ejecutivo
Este an√°lisis describe una cadena de ataque donde un **script malicioso** llega al sistema a trav√©s de una **memoria USB**.  
Al ser ejecutado, realiza las siguientes acciones:

- Captura de teclas (keylogger con `pynput`)
- Grabaci√≥n de video con la c√°mara (`cv2.VideoCapture`)
- Recolecci√≥n de informaci√≥n del sistema y red (`psutil`, `platform`, `socket`)
- Exfiltraci√≥n de los datos por correo (`smtplib` ‚Üí `smtp.gmail.com:587`)

---

| Acci√≥n | Implementaci√≥n t√©cnica | Descripci√≥n |
|--------|----------------------|------------|
| Captura de teclas | keylogger con `pynput` | El script registra las pulsaciones del teclado usando la librer√≠a `pynput`. |
| Grabaci√≥n de v√≠deo con la c√°mara | `cv2.VideoCapture` | Utiliza OpenCV (`cv2`) para acceder a la c√°mara y capturar video. |
| Recolecci√≥n de informaci√≥n del sistema y red | `psutil`, `platform`, `socket` | Obtiene datos del hardware, CPU, memoria, disco y configuraci√≥n de red mediante estas librer√≠as. |
| Exfiltraci√≥n de los datos por correo | `smtplib` ‚Üí `smtp.gmail.com:587` | Env√≠a los datos recopilados usando la librer√≠a est√°ndar de Python `smtplib` hacia un servidor SMTP espec√≠fico. |


# üß† Diagrama de Cadena de Ataque 

Este diagrama muestra la secuencia de un ataque mediante un script malicioso, usando t√©rminos simples para usuarios no t√©cnicos. Los c√≥digos MITRE ATT&CK se mantienen para referencia t√©cnica.

```mermaid
flowchart LR
  subgraph Acceso_Inicial [Acceso Inicial]
    direction TB
    A["USB o dispositivo externo\nT1091 / T1204"]
  end

  subgraph Recoleccion [Recolecci√≥n de Informaci√≥n]
    direction TB
    B["Registro de teclas (Keylogger)\nT1056.001"]
    C["Grabaci√≥n de v√≠deo con la c√°mara\nT1125"]
  end

  subgraph Descubrimiento [Descubrimiento del Sistema]
    direction TB
    D["Obtiene informaci√≥n del equipo y red\nT1082 / T1016"]
  end

  subgraph Exfiltracion [Env√≠o de Informaci√≥n]
    direction TB
    E["Env√≠a datos por correo electr√≥nico\nT1048 / T1071.003"]
  end

  subgraph Evidencias [Archivos generados / IoCs]
    direction TB
    F["Archivos de video, texto y datos del usuario"]
  end

  %% Flujo
  A --> B
  B --> C
  B --> D
  C --> D
  D --> E
  E --> F

  %% Estilo de nodos (texto m√°s grande y oscuro)
  classDef box fill:#ffffff,stroke:#333,stroke-width:1px,font-size:20px,color:#000000,padding:10px;
  class A,B,C,D,E,F box;

  %% Estilo t√≠tulos subgr√°ficos
  style Acceso_Inicial font-size:16px;
  style Recoleccion font-size:16px;
  style Descubrimiento font-size:16px;
  style Exfiltracion font-size:16px;
  style Evidencias font-size:16px;

  %% Fondos por t√°ctica
  style Acceso_Inicial fill:#f39c12,stroke:#e67e22,stroke-width:1px;
  style Recoleccion fill:#3498db,stroke:#1f78b4,stroke-width:1px;
  style Descubrimiento fill:#2ecc71,stroke:#27ae60,stroke-width:1px;
  style Exfiltracion fill:#e74c3c,stroke:#c0392b,stroke-width:1px;
  style Evidencias fill:#95a5a6,stroke:#7f8c8d,stroke-width:1px;

  linkStyle default stroke:#444,stroke-width:2px;
