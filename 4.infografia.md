---
marp: true
theme: default
paginate: true
header: "AnÃ¡lisis de Script Malicioso â€” Keylogger + Webcam"
footer: "SustentaciÃ³n de Ciberseguridad | 2025"
---

# ðŸ›¡ï¸ AnÃ¡lisis de Script Malicioso
### Keylogger + GrabaciÃ³n de Webcam + ExfiltraciÃ³n SMTP

> **Resumen:** El script captura la actividad del usuario, graba vÃ­deo desde la cÃ¡mara, recoge informaciÃ³n del sistema y la envÃ­a a una cuenta externa vÃ­a correo.

---

## âš™ï¸ Componentes Principales

| MÃ³dulo / Componente | FunciÃ³n | Riesgo |
|---|---|---|
| `pynput` | Captura teclado y ratÃ³n | ðŸ”´ Keylogging |
| `cv2 (OpenCV)` | Graba desde la webcam | ðŸ”´ Espionaje visual |
| `psutil` | Recolecta info del sistema | ðŸŸ  Fingerprinting |
| `pickle` | Serializa datos (`tabla_datos`) | ðŸŸ  EjecuciÃ³n remota posible |
| `smtplib`, `email.mime` | EnvÃ­a datos por correo | ðŸ”´ ExfiltraciÃ³n |
| Credenciales en texto | Acceso SMTP directo | ðŸ”´ ExposiciÃ³n de credenciales |

---

## ðŸ§© Variables y comportamiento clave

- `tabla_datos = []` â†’ almacena teclas, clics y movimientos.  
- `last_click` â†’ controla doble clic.  
- `VideoRecorder()` â†’ graba video (45 s).  
- Listeners (`on_press`, `on_move`, `on_click`, `on_scroll`).  
- `correo_send()` â†’ empaqueta datos y los envÃ­a por SMTP.  

> **Efecto final:** captura, graba, serializa, exfiltra.

---

## ðŸ” Flujo de datos

```mermaid
graph LR
  A[Usuario] -->|Teclas / Movimiento| B[tabla_datos]
  A -->|Webcam| C[VideoRecorder -> .mp4]
  B --> D[Pickle -> archivo .txt]
  D --> E[correo_send]
  C --> E
  E --> F[Cuenta Gmail remota]
