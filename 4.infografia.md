---
marp: true
theme: default
paginate: true
header: "Análisis de Script Malicioso — Keylogger + Webcam"
footer: "Sustentación de Ciberseguridad | 2025"
---

# 🛡️ Análisis de Script Malicioso
### Keylogger + Grabación de Webcam + Exfiltración SMTP

> **Resumen:** El script captura la actividad del usuario, graba vídeo desde la cámara, recoge información del sistema y la envía a una cuenta externa vía correo.

---

## ⚙️ Componentes Principales

| Módulo / Componente | Función | Riesgo |
|---|---|---|
| `pynput` | Captura teclado y ratón | 🔴 Keylogging |
| `cv2 (OpenCV)` | Graba desde la webcam | 🔴 Espionaje visual |
| `psutil` | Recolecta info del sistema | 🟠 Fingerprinting |
| `pickle` | Serializa datos (`tabla_datos`) | 🟠 Ejecución remota posible |
| `smtplib`, `email.mime` | Envía datos por correo | 🔴 Exfiltración |
| Credenciales en texto | Acceso SMTP directo | 🔴 Exposición de credenciales |

---

## 🧩 Variables y comportamiento clave

- `tabla_datos = []` → almacena teclas, clics y movimientos.  
- `last_click` → controla doble clic.  
- `VideoRecorder()` → graba video (45 s).  
- Listeners (`on_press`, `on_move`, `on_click`, `on_scroll`).  
- `correo_send()` → empaqueta datos y los envía por SMTP.  

> **Efecto final:** captura, graba, serializa, exfiltra.

---

## 🔁 Flujo de datos

```mermaid
graph LR
  A[Usuario] -->|Teclas / Movimiento| B[tabla_datos]
  A -->|Webcam| C[VideoRecorder -> .mp4]
  B --> D[Pickle -> archivo .txt]
  D --> E[correo_send]
  C --> E
  E --> F[Cuenta Gmail remota]
