---
marp: true
theme: default
paginate: true
header: 'Análisis & Respuesta: Script Keylogger + Webcam + Exfiltración'
footer: 'Informe Técnico — Sustentación'
---

# 🛡️ Análisis de script malicioso  
### Keylogger + Grabación Webcam + Exfiltración SMTP  
**Resumen (una frase):** captura actividad del usuario, graba vídeo, recopila info del equipo y la envía por correo a una cuenta remota.

<!-- Notas expositor: Introducción breve al caso. Resaltar impacto en privacidad. -->

---

## ⚙️ Componentes principales (visión rápida)

| Componente | Función | Riesgo |
|---:|:---|:---:|
| `pynput` (mouse/keyboard) | Captura teclas y movimientos | ✅ Keylogging |
| `cv2` (OpenCV) | Graba video desde webcam | ✅ Espionaje visual |
| `psutil` | Recolecta información del sistema y red | ✅ Fingerprinting |
| `pickle` | Serializa `tabla_datos` | ⚠️ RCE si manipulado |
| `smtplib` + `email.mime` | Envía archivos por SMTP | ✅ Exfiltración de datos |
| Credenciales en texto | Usadas para login SMTP | 🚫 Exposición de credenciales |

<!-- Notas expositor: Mostrar tabla y comentar brevemente cada fila. -->

---

## 🧾 Variables y comportamiento clave

- `tabla_datos = []` → almacena eventos (teclas, clicks, movimientos).
- `last_click` → detecta doble click.
- `habla(texto)` → feedback audible con `pyttsx3`.
- `VideoRecorder` → graba webcam en hilo (45 s por defecto).
- Listeners `on_press/on_move/on_click/on_scroll` → llenan `tabla_datos`.
- `correo_send(...)` → deserializa `pickle`, formatea texto y envía por SMTP.

<!-- Notas expositor: Aclarar flujo lógico: captura → guarda → serializa → envía. -->

---

## 🔁 Flujo de datos (diagrama)

```mermaid
graph LR
    A[Usuario] -->|Teclas / Movimientos| B[tabla_datos (memoria)]
    A -->|Webcam frames| C[Archivo .mp4 en Data_Video]
    B --> D[pickle -> Data_Archivo_txt/*.txt]
    C --> E[Adjunto .mp4]
    D --> F[correo_send -> SMTP]
    E --> F
    F --> G[jcbotonero97@gmail.com (remoto)]

